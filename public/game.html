<!DOCTYPE html><html lang="en"><head><meta charset="UTF-8"><title>Color Prediction Game</title><link rel="stylesheet" href="style.css"><style>.color-buttons button { margin: 10px; width: 80px; height: 80px; border-radius: 50%; font-size: 14px; } #red { background-color: #dc3545; } #green { background-color: #28a745; } #blue { background-color: #007bff; }</style></head><body>
<div class="game-container"><h1>Color Prediction Game</h1><p>Balance: <b id="balance">...</b></p><input type="number" id="betAmount" placeholder="Enter bet amount" min="1"><div class="color-buttons"><button id="red" onclick="play('red')">RED</button><button id="green" onclick="play('green')">GREEN</button><button id="blue" onclick="play('blue')">BLUE</button></div><p id="message">Choose a color to start!</p><a href="/lobby.html">Back to Lobby</a></div>
<script>
const token = localStorage.getItem('authToken');
if (!token) window.location.href = '/index.html';
const balanceEl = document.getElementById('balance');
const messageEl = document.getElementById('message');
const betInput = document.getElementById('betAmount');
const colorButtons = document.querySelectorAll('.color-buttons button');
function setButtonsDisabled(disabled) { colorButtons.forEach(b => b.disabled = disabled); }
async function fetchBalance() {
    const res = await fetch('/api/game/balance', { headers: { 'x-auth-token': token }});
    if (res.ok) {
        const data = await res.json();
        balanceEl.textContent = `₹${data.balance.toFixed(2)}`;
    } else { window.location.href = '/index.html'; }
}
async function play(chosenColor) {
    const betAmount = Number(betInput.value);
    if (!betAmount || betAmount <= 0) { alert("Please enter a valid bet amount."); return; }
    setButtonsDisabled(true);
    messageEl.textContent = 'Spinning...';
    const res = await fetch('/api/game/play-color-game', { method: 'POST', headers: { 'Content-Type': 'application/json', 'x-auth-token': token }, body: JSON.stringify({ betAmount, chosenColor }) });
    const data = await res.json();
    if (res.ok) {
        messageEl.textContent = data.message;
        messageEl.style.color = data.winningColor;
        balanceEl.textContent = `₹${data.newBalance.toFixed(2)}`;
    } else {
        messageEl.textContent = data.message;
        messageEl.style.color = 'red';
    }
    setButtonsDisabled(false);
}
document.addEventListener('DOMContentLoaded', fetchBalance);
</script></body></html>
